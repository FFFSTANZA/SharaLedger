[
  {
    "name": "pl-variance-analysis",
    "templateId": "pl-variance-analysis",
    "contextType": "Report",
    "contextField": "profit_value",
    "questionText": "Why did profit change this period?",
    "queryFunction": "compare_pl_periods",
    "answerTemplate": "Your profit {increased/decreased} by ₹{amount} ({percentage}%) from ₹{prev_amount} to ₹{curr_amount}. Top {count} contributors: {breakdown_list}",
    "requiredDoctypes": "AccountingLedgerEntry,Account",
    "isActive": 1,
    "trustLevel": "1",
    "displayOrder": 1,
    "availableParameters": "[{\"type\":\"group_by\",\"label\":\"By Customer\",\"field\":\"party\",\"applies_to\":[\"Sales Income\"]},{\"type\":\"group_by\",\"label\":\"By Month\",\"field\":\"period\"},{\"type\":\"filter\",\"label\":\"Last 30 Days\",\"date_range\":\"last_30_days\"},{\"type\":\"limit\",\"label\":\"Top 10\",\"value\":10},{\"type\":\"compare\",\"label\":\"Compare to Last Year\",\"compare_to\":\"last_year\"}]"
  },
  {
    "name": "ledger-balance-breakdown",
    "templateId": "ledger-balance-breakdown",
    "contextType": "Ledger",
    "contextField": "balance_amount",
    "questionText": "What transactions built this balance?",
    "queryFunction": "trace_ledger_movements",
    "answerTemplate": "This balance of ₹{amount} consists of {count} transactions: {transaction_list}",
    "requiredDoctypes": "AccountingLedgerEntry,Payment,JournalEntry",
    "isActive": 1,
    "trustLevel": "1",
    "displayOrder": 2,
    "availableParameters": "[{\"type\":\"drill_down\",\"label\":\"Show All Transactions\",\"target\":\"transaction_list\"},{\"type\":\"filter\",\"label\":\"Last 7 Days\",\"date_range\":\"last_7_days\"},{\"type\":\"filter\",\"label\":\"Last Quarter\",\"date_range\":\"last_quarter\"},{\"type\":\"group_by\",\"label\":\"By Voucher Type\",\"field\":\"voucher_type\"}]"
  },
  {
    "name": "customer-outstanding-analysis",
    "templateId": "customer-outstanding-analysis",
    "contextType": "Customer",
    "contextField": "outstanding_amount",
    "questionText": "Why is this customer's outstanding high?",
    "queryFunction": "analyze_customer_outstanding",
    "answerTemplate": "Outstanding of ₹{amount} from {invoice_count} invoices. {overdue_count} invoices overdue. Average payment cycle: {avg_days} days.",
    "requiredDoctypes": "SalesInvoice,Payment",
    "isActive": 1,
    "trustLevel": "1",
    "displayOrder": 3,
    "availableParameters": "[{\"type\":\"filter\",\"label\":\"Last 30 Days\",\"date_range\":\"last_30_days\"},{\"type\":\"drill_down\",\"label\":\"Payment Pattern\",\"target\":\"detail_view\"},{\"type\":\"limit\",\"label\":\"Top 5 Invoices\",\"value\":5},{\"type\":\"compare\",\"label\":\"Compare to Last Year\",\"compare_to\":\"last_year\"}]"
  },
  {
    "name": "cash-movement-analysis",
    "templateId": "cash-movement-analysis",
    "contextType": "Account",
    "contextField": "balance_amount",
    "questionText": "Why did cash decrease this month?",
    "queryFunction": "trace_ledger_movements",
    "answerTemplate": "Cash decreased by ₹{amount} due to {payment_count} payments totaling ₹{payment_total} and {receipt_count} receipts totaling ₹{receipt_total}",
    "requiredDoctypes": "AccountingLedgerEntry,Payment",
    "isActive": 1,
    "trustLevel": "1",
    "displayOrder": 4,
    "availableParameters": "[{\"type\":\"drill_down\",\"label\":\"Show All Transactions\",\"target\":\"transaction_list\"},{\"type\":\"filter\",\"label\":\"Last 7 Days\",\"date_range\":\"last_7_days\"},{\"type\":\"group_by\",\"label\":\"By Party\",\"field\":\"party\"}]"
  },
  {
    "name": "top-expenses-analysis",
    "templateId": "top-expenses-analysis",
    "contextType": "Report",
    "contextField": "expense_value",
    "questionText": "What are my top 5 expenses?",
    "queryFunction": "compare_pl_periods",
    "answerTemplate": "Top 5 expenses: {expense_list}. Total: ₹{total_amount} ({percentage}% of revenue)",
    "requiredDoctypes": "AccountingLedgerEntry,Account",
    "isActive": 1,
    "trustLevel": "1",
    "displayOrder": 5,
    "availableParameters": "[{\"type\":\"group_by\",\"label\":\"By Account\",\"field\":\"account\"},{\"type\":\"group_by\",\"label\":\"By Month\",\"field\":\"period\"},{\"type\":\"limit\",\"label\":\"Top 10\",\"value\":10},{\"type\":\"compare\",\"label\":\"Compare to Last Month\",\"compare_to\":\"last_month\"},{\"type\":\"drill_down\",\"label\":\"View All Entries\",\"target\":\"ledger_view\"}]"
  },
  {
    "name": "gst-liability-analysis",
    "templateId": "gst-liability-analysis",
    "contextType": "Account",
    "contextField": "balance_amount",
    "questionText": "Why is GST liability high/low?",
    "queryFunction": "trace_ledger_movements",
    "answerTemplate": "GST liability of ₹{amount}: Collected ₹{collected} from {invoice_count} invoices, Paid ₹{paid} from {payment_count} payments",
    "requiredDoctypes": "AccountingLedgerEntry,SalesInvoice,PurchaseInvoice",
    "isActive": 1,
    "trustLevel": "1",
    "displayOrder": 6,
    "availableParameters": "[{\"type\":\"filter\",\"label\":\"Last 30 Days\",\"date_range\":\"last_30_days\"},{\"type\":\"filter\",\"label\":\"Current FY\",\"date_range\":\"current_fy\"},{\"type\":\"group_by\",\"label\":\"By Month\",\"field\":\"period\"},{\"type\":\"drill_down\",\"label\":\"Show All Transactions\",\"target\":\"transaction_list\"}]"
  },
  {
    "name": "vendor-payment-ranking",
    "templateId": "vendor-payment-ranking",
    "contextType": "Vendor",
    "contextField": "total_paid",
    "questionText": "Which vendor am I paying the most to?",
    "queryFunction": "analyze_customer_outstanding",
    "answerTemplate": "Top vendor: {vendor_name} - Paid ₹{amount} ({percentage}% of total vendor payments) from {payment_count} payments",
    "requiredDoctypes": "Payment,PurchaseInvoice",
    "isActive": 1,
    "trustLevel": "1",
    "displayOrder": 7,
    "availableParameters": "[{\"type\":\"filter\",\"label\":\"Last 30 Days\",\"date_range\":\"last_30_days\"},{\"type\":\"filter\",\"label\":\"Last Quarter\",\"date_range\":\"last_quarter\"},{\"type\":\"limit\",\"label\":\"Top 5\",\"value\":5},{\"type\":\"limit\",\"label\":\"Top 10\",\"value\":10}]"
  },
  {
    "name": "expense-variance-analysis",
    "templateId": "expense-variance-analysis",
    "contextType": "Account",
    "contextField": "balance_amount",
    "questionText": "Why is this expense higher than expected?",
    "queryFunction": "compare_pl_periods",
    "answerTemplate": "This expense increased by ₹{variance} ({percentage}%) compared to previous period. Contributing transactions: {transaction_list}",
    "requiredDoctypes": "AccountingLedgerEntry,Account",
    "isActive": 1,
    "trustLevel": "2",
    "displayOrder": 8,
    "availableParameters": "[{\"type\":\"compare\",\"label\":\"Compare to Last Month\",\"compare_to\":\"last_month\"},{\"type\":\"compare\",\"label\":\"Compare to Last Year\",\"compare_to\":\"last_year\"},{\"type\":\"drill_down\",\"label\":\"View All Entries\",\"target\":\"ledger_view\"},{\"type\":\"group_by\",\"label\":\"By Party\",\"field\":\"party\"}]"
  },
  {
    "name": "customer-payment-pattern",
    "templateId": "customer-payment-pattern",
    "contextType": "Customer",
    "contextField": "payment_history",
    "questionText": "Show payment pattern for this customer",
    "queryFunction": "analyze_customer_outstanding",
    "answerTemplate": "Payment pattern: {payment_count} payments averaging ₹{avg_amount} every {avg_days} days. Last payment: {last_payment_date}",
    "requiredDoctypes": "Payment,SalesInvoice",
    "isActive": 1,
    "trustLevel": "1",
    "displayOrder": 9,
    "availableParameters": "[{\"type\":\"filter\",\"label\":\"Last 30 Days\",\"date_range\":\"last_30_days\"},{\"type\":\"filter\",\"label\":\"Last Quarter\",\"date_range\":\"last_quarter\"},{\"type\":\"drill_down\",\"label\":\"Show All Payments\",\"target\":\"transaction_list\"},{\"type\":\"compare\",\"label\":\"Compare to Last Year\",\"compare_to\":\"last_year\"}]"
  },
  {
    "name": "overdue-invoices-aging",
    "templateId": "overdue-invoices-aging",
    "contextType": "Customer",
    "contextField": "outstanding_amount",
    "questionText": "Which invoices are overdue?",
    "queryFunction": "analyze_customer_outstanding",
    "answerTemplate": "{overdue_count} invoices overdue totaling ₹{amount}. Aging: {aging_0_30} (0-30 days), {aging_30_60} (30-60 days), {aging_60_90} (60-90 days), {aging_90_plus} (90+ days)",
    "requiredDoctypes": "SalesInvoice",
    "isActive": 1,
    "trustLevel": "1",
    "displayOrder": 10,
    "availableParameters": "[{\"type\":\"filter\",\"label\":\"Show Only 90+ Days\",\"date_range\":\"custom\"},{\"type\":\"limit\",\"label\":\"Top 5\",\"value\":5},{\"type\":\"drill_down\",\"label\":\"Show All Invoices\",\"target\":\"transaction_list\"},{\"type\":\"group_by\",\"label\":\"By Age Bucket\",\"field\":\"age_bucket\"}]"
  }
]
